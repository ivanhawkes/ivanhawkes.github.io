<!doctype html><html>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<link rel=apple-touch-icon href=/img/apple-icon.png>
<link rel=icon href=/img/favicon.png>
<title>Life Reboot</title>
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Installing Nginx using Docker and Portainer">
<meta name=twitter:description content="Quick instructions on getting Nginx up and running again for my site using Docker and Portainer.">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
<div class=container-fluid>
<a class=navbar-brand href=https://ivanhawkes.github.io/>Ivan Hawkes</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
<div class="collapse navbar-collapse" id=navbarSupportedContent>
<ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class=nav-item>
<a href=https://ivanhawkes.github.io/post class="nav-link d-flex align-items-center">
<i class=bi-stickies></i>&#160;Posts
</a>
</li>
<li class=nav-item>
<a href=https://ivanhawkes.github.io/project class="nav-link d-flex align-items-center">
<i class=bi-kanban></i>&#160;Our Projects
</a>
</li>
<li class=nav-item>
<a href=https://ivanhawkes.github.io/profile class="nav-link d-flex align-items-center">
<i class=bi-file-earmark-person></i>&#160;Our Team
</a>
</li>
<li class=nav-item>
<a href=https://ivanhawkes.github.io/recipe class="nav-link d-flex align-items-center">
<i class=bi-egg-fried></i>&#160;Recipes
</a>
</li>
<li class=nav-item>
<a href=https://ivanhawkes.github.io/garden class="nav-link d-flex align-items-center">
<i class=bi-tree></i>&#160;Garden
</a>
</li>
<li class=nav-item>
<a href=https://ivanhawkes.github.io/plant class="nav-link d-flex align-items-center">
<i class=bi-flower1></i>&#160;Plants
</a>
</li>
<li class=nav-item>
<a href=https://ivanhawkes.github.io/about class="nav-link d-flex align-items-center">
<i class=bi-person-lines-fill></i>&#160;About Us
</a>
</li>
</ul>
</div>
</div>
</nav>
<div class=container>
<div class=container>
<div class=row>
<div class="col text-center">
<h1>Installing Nginx using Docker and Portainer</h1>
<div class=card>
<div class="card-header card-header-image">
<a href=#pablo>
<img src=/img/site/category/programming.jpg class=card-img-top alt>
</a>
<div class=colored-shadow style=background-image:url(/img/site/category/programming.jpg);opacity:1></div>
</div>
<div class=card-body>
<p class=text-start></p>
</div>
</div>
</div>
</div>
<div class=row>
<div class=col-12>
<hr>
</div>
</div>
<div class=row>
<div class=col-6>
<p class=h6>
By Ivan Hawkes<br>November 24, 2021
</p>
</div>
<div class="col-6 text-end">
<a href="https://www.facebook.com/sharer/sharer.php?u=ivan.hawkes" class=btn target=_blank>
<i class=bi-facebook style=font-size:32px></i>
</a>
<a href="https://twitter.com/intent/tweet?url=%40ivanhawkes" class=btn target=_blank>
<i class=bi-twitter style=font-size:32px></i>
</a>
<a href="https://www.linkedin.com/shareArticle?mini=true&url=ivan-hawkes-a8386338" class=btn target=_blank>
<i class=bi-linkedin style=font-size:32px></i></a>
<a href="http://www.pinterest.com/pin/find/?url=ivanhawkes" class=btn target=_blank>
<i class=bi-pinterest style=font-size:32px></i></a>
</div>
</div>
<div class=row>
<div class=col-12>
<hr>
</div>
</div>
<div class=row>
<div class=col>
<p>Quick instructions on getting Nginx up and running again for my site using Docker and Portainer.</p>
<p>It goes without saying you will need both Docker and Portainer installed on your server.</p>
<p>I installed Nginx using the default app templates. At one point I tried using a set being developed by Novaspirit Tech, but they didn&rsquo;t include &lsquo;apt&rsquo; and so I couldn&rsquo;t install Certbot. I reverted to the old app templates after removing the install, and then proceded as usual.</p>
<p>First step - make a new container and call it &lsquo;nginx&rsquo;.</p>
<p>I decided, after having a false start, to install both Plex and Nginx on the host network. This isn&rsquo;t the best solution, but I didn&rsquo;t want to spend all night finding out why Plex wasn&rsquo;t working correctly with Nginx proxying it on a different network segment.</p>
<p>Installing the baseline files worked seamlessly thanks to Docker and Portainer.</p>
<p>Once the container is running, jump into a BASH shell and install Certbot and configure the websites. In this case, I only need to:</p>
<ul>
<li>remove the default website</li>
<li>create a proxy for the Plex site</li>
<li>create a virtual site for my personal website</li>
</ul>
<h5 id=heading></h5>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e># Update any out of date software.</span>
apt update <span style=color:#f92672>&amp;&amp;</span> apt upgrade

<span style=color:#75715e># Ensure we have Certbot.</span>
apt install certbot python3-certbot-nginx

<span style=color:#75715e># Backup the shipped config, replace it with my own, and then remove the default site.</span>
cd /etc/nginx/
cp nginx.conf nginx.conf.orig
nano nginx.conf
rm conf.d/default.conf

<span style=color:#75715e># Add a proxy for the Plex site.</span>
nano conf.d/plex.conf

<span style=color:#75715e># Make a new virtual site for my blog.</span>
mkdir sites-available
mkdir sites-enabled
nano sites-available/hawkes.info
cd sites-enabled/
ln -s ../sites-available/hawkes.info hawkes.info
cat hawkes.info
cd ..

<span style=color:#75715e># Create fresh certificates for the site(s).</span>
certbot --nginx

<span style=color:#75715e># Reload the web server.</span>
service nginx reload

<span style=color:#75715e># We&#39;re done, probably.</span>
exit
</code></pre></div>
</div>
</div>
<div class=row>
<div class=col-12>
<hr>
</div>
</div>
<div class=row>
<div class=col>
<p class=h6>
Discover more posts like this:
</p>
<p class=h6>
<a class="btn btn-primary" href=/tags/linux>
Linux
</a>
<a class="btn btn-primary" href=/tags/ubuntu>
Ubuntu
</a>
<a class="btn btn-primary" href=/tags/nginx>
NGinx
</a>
</p>
</div>
</div>
<div class=row>
<div class=col>
<hr>
</div>
</div>
<div class=row>
<div class="col-6 text-start">
Previous:<br><a href=https://ivanhawkes.github.io/post/moving-into-ubuntu/> Moving into a Fresh Ubuntu Install</a>
</div>
<div class="col-6 text-end">
Next:<br><a href=https://ivanhawkes.github.io/post/building-a-joystick-part-01/> Building A Joystick (Part 1)</a>
</div>
</div>
</div>
</div>
<footer>
<div class=row>
<div class=col>
<hr>
</div>
</div>
<nav class="navbar navbar-expand-lg">
<div class=container-fluid>
&copy; 2021 Ivan Hawkes all rights reserved.
</div>
</nav>
</footer>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css integrity=sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3 crossorigin=anonymous>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js integrity=sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM crossorigin=anonymous></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.6.0/font/bootstrap-icons.css integrity=sha384-7ynz3n3tAGNUYFZD3cWe5PDcE36xj85vyFkawcF6tIwxvIecqKvfwLiaFdizhPpN crossorigin=anonymous>
<link rel=stylesheet type=text/css href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons">
</body>
</html>